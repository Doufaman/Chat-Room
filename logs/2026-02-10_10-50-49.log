10:50:49 [root] [INFO] 日志系统初始化完成。文件保存至: logs/2026-02-10_10-50-49.log
10:51:05 [utills.ip_validator] [DEBUG] IP 127.0.0.2 是回环地址（本地测试用）
10:51:05 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Election Manager starting
10:51:05 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] UDP listener started on UDP:9003
10:51:06 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.1...
10:51:06 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.1
10:51:07 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717067.818423, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:10 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717070.817247, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:13 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717073.813795, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:16 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717076.8184278, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:19 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717079.8184252, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:22 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717082.818419, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:25 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717085.816112, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:28 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717088.814689, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1'}
10:51:29 [server_role] [INFO] [Follower] New follower joined: 45924667 with IP: 127.0.0.3. Updated membership list: {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:51:31 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717091.815398, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:51:34 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717094.8169758, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:51:37 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717097.8145332, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:51:40 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717100.818072, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:51:43 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 605148904, 'timestamp': 1770717103.8184261, 'identity': 'LEADER'} from 605148904, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:51:49 [server.heartbeat] [ERROR] [I'm Follower - 28830870] Failed to send heartbeat to leader 605148904: [Errno 32] Broken pipe
10:51:52 [network_manager] [ERROR] No connection found for 605148904, cannot send message
10:51:55 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:51:55 [election] [WARNING] [I'm Follower - (28830870, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:51:55 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Challenged by 45924667, sending ANSWER to 127.0.0.3
10:51:55 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Election started; peers=[605148904, 45924667]
10:51:55 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Challenging higher peers: [605148904, 45924667]
10:51:55 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.1:9003
10:51:55 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:51:55 [network_manager] [ERROR] No connection found for 605148904, cannot send message
10:51:56 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:51:56 [fault_detection] [INFO] Election already in progress, skipping trigger
10:51:58 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:51:58 [fault_detection] [INFO] Election already in progress, skipping trigger
10:51:58 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] No ANSWER received, becoming Leader
10:51:58 [server_role] [DEBUG] Closed connection to old leader 605148904
10:51:58 [network_manager] [ERROR] No connection found for 28830870, cannot send message
10:51:59 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [membership] [INFO] server 28830870 assigned to group group_0
10:51:59 [membership] [INFO] Leader initialized with server info: {'server_id': 28830870, 'load_info': {'cpu_percent': 5.9, 'memory_percent': 76.1}, 'address': '127.0.0.2'}
10:51:59 [membership] [INFO] server added: 605148904
10:51:59 [server_role] [INFO] [Leader] Initialized server 605148904 in membership
10:51:59 [membership] [INFO] server added: 45924667
10:51:59 [server_role] [INFO] [Leader] Initialized server 45924667 in membership
10:51:59 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:51:59 [network_manager] [DEBUG] Leader long-lived connection listener started
10:51:59 [server_role] [INFO] [Leader] Notifying followers about new leader: 28830870
10:51:59 [server_role] [INFO] [Leader] Notified follower 605148904 at 127.0.0.1 about new leader
10:51:59 [server_role] [INFO] [Leader] Notified follower 45924667 at 127.0.0.3 about new leader
10:51:59 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717119.596102, 'identity': 'LEADER'}
10:51:59 [network_manager] [DEBUG] there are currently 0 followers to send to: []
10:51:59 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:51:59 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:51:59 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Demoting to Follower, new Leader: 45924667
10:51:59 [election] [DEBUG] [I'm Leader - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:51:59 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:51:59 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:51:59 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:51:59 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:51:59 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:52:00 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:52:00 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:52:00 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:52:00 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:52:00 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 45924667 (127.0.0.3)
10:52:00 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 45924667
10:52:00 [membership] [ERROR] illegal operation (not leader)
10:52:02 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717122.5353138, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:52:05 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717125.5368252, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:52:08 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717128.536812, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:52:11 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717131.536818, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 605148904: '127.0.0.1', 45924667: '127.0.0.3'}
10:52:13 [server_role] [INFO] [Follower] Server removed: 605148904 from group None. Updated membership list: {28830870: '127.0.0.2', 45924667: '127.0.0.3'}
10:52:14 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717134.536808, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3'}
10:52:17 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717137.5368152, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3'}
10:52:20 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717140.536818, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3'}
10:52:23 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717143.535594, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3'}
10:52:26 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717146.536819, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3'}
10:52:27 [server_role] [INFO] [Follower] New follower joined: 99218811 with IP: 127.0.0.4. Updated membership list: {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4'}
10:52:29 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717149.535891, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4'}
10:52:35 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717155.536739, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4'}
10:52:38 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717158.536818, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4'}
10:52:40 [server_role] [INFO] [Follower] New follower joined: 989798494 with IP: 127.0.0.5. Updated membership list: {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:52:41 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717161.533696, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:52:44 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717164.536813, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:52:47 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717167.536812, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:52:50 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717170.532359, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:52:53 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717173.53391, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:52:56 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717176.531859, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:02 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717182.535059, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:05 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 45924667, 'timestamp': 1770717185.5368268, 'identity': 'LEADER'} from 45924667, current memnershiplist is {28830870: '127.0.0.2', 45924667: '127.0.0.3', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:13 [server.heartbeat] [ERROR] [I'm Follower - 28830870] Failed to send heartbeat to leader 45924667: [Errno 32] Broken pipe
10:53:15 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:53:15 [election] [WARNING] [I'm Follower - (28830870, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:53:16 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Election started; peers=[45924667, 99218811, 989798494]
10:53:16 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Challenging higher peers: [45924667, 99218811, 989798494]
10:53:16 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:53:16 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.4:9003
10:53:16 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.5:9003
10:53:16 [network_manager] [ERROR] No connection found for 45924667, cannot send message
10:53:17 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:53:17 [fault_detection] [INFO] Election already in progress, skipping trigger
10:53:18 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:53:18 [fault_detection] [INFO] Election already in progress, skipping trigger
10:53:19 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] No ANSWER received, becoming Leader
10:53:19 [server_role] [DEBUG] Closed connection to old leader 45924667
10:53:19 [network_manager] [ERROR] No connection found for 28830870, cannot send message
10:53:20 [membership] [INFO] server 28830870 assigned to group group_0
10:53:20 [membership] [INFO] Leader initialized with server info: {'server_id': 28830870, 'load_info': {'cpu_percent': 7.7, 'memory_percent': 76.0}, 'address': '127.0.0.2'}
10:53:20 [membership] [INFO] server added: 99218811
10:53:20 [server_role] [INFO] [Leader] Initialized server 99218811 in membership
10:53:20 [membership] [INFO] server added: 989798494
10:53:20 [server_role] [INFO] [Leader] Initialized server 989798494 in membership
10:53:20 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:53:20 [network_manager] [DEBUG] Leader long-lived connection listener started
10:53:20 [server_role] [INFO] [Leader] Notifying followers about new leader: 28830870
10:53:20 [server_role] [INFO] [Leader] Notified follower 45924667 at 127.0.0.3 about new leader
10:53:20 [server_role] [INFO] [Leader] Notified follower 99218811 at 127.0.0.4 about new leader
10:53:20 [server_role] [INFO] [Leader] Notified follower 989798494 at 127.0.0.5 about new leader
10:53:20 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717200.15274, 'identity': 'LEADER'}
10:53:20 [network_manager] [DEBUG] there are currently 0 followers to send to: []
10:53:20 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:53:20 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:53:20 [election] [DEBUG] [I'm Leader - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:20 [network_manager] [DEBUG] Registered long-lived connection from follower 99218811 at ('127.0.0.2', 62981)
10:53:20 [network_manager] [DEBUG] Registered long-lived connection from follower 989798494 at ('127.0.0.2', 62982)
10:53:20 [membership] [INFO] server 605148904 status changed: ACTIVE -> SUSPECT
10:53:20 [membership] [INFO] server 45924667 status changed: ACTIVE -> SUSPECT
10:53:20 [fault_detection] [INFO] Suspected servers: [605148904, 45924667]. Sending probes.
10:53:20 [network_manager] [ERROR] No connection found for 605148904, cannot send message
10:53:20 [network_manager] [ERROR] No connection found for 45924667, cannot send message
10:53:20 [election] [DEBUG] [I'm Leader - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:20 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Challenged by 99218811, sending ANSWER to 127.0.0.4
10:53:20 [election] [DEBUG] [I'm Leader - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:20 [election] [DEBUG] [I'm Leader - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:20 [election] [DEBUG] [I'm Leader - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:21 [fault_detection] [WARNING] 605148904 did not respond -> mark DEAD
10:53:21 [membership] [INFO] server 605148904 status changed: SUSPECT -> DEAD
10:53:21 [membership] [INFO] server removed: 605148904
10:53:21 [fault_discovery] [INFO] Handling dead server 605148904
10:53:21 [membership] [WARNING] server 605148904 is not existed
10:53:21 [membership] [WARNING] server 605148904 is not assigned to any group
10:53:21 [fault_detection] [WARNING] 45924667 did not respond -> mark DEAD
10:53:21 [membership] [INFO] server 45924667 status changed: SUSPECT -> DEAD
10:53:21 [membership] [INFO] server removed: 45924667
10:53:21 [fault_discovery] [INFO] Handling dead server 45924667
10:53:21 [membership] [WARNING] server 45924667 is not existed
10:53:21 [membership] [WARNING] server 45924667 is not assigned to any group
10:53:21 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:21 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Demoting to Follower, new Leader: 989798494
10:53:21 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.5...
10:53:21 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.5
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:21 [network_manager] [DEBUG] Registered long-lived connection from follower 99218811 at ('127.0.0.5', 62991)
10:53:21 [network_manager] [DEBUG] Registered long-lived connection from follower 28830870 at ('127.0.0.5', 62992)
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:21 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:22 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:22 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:22 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:22 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:22 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717201.964399, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 7.8, 'memory_percent': 76.2}} from 28830870, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:22 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:53:25 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717204.964777, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 5.9, 'memory_percent': 75.9}} from 28830870, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:25 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:53:28 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 99218811, 'timestamp': 1770717207.336579, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 9.5, 'memory_percent': 75.7}} from 99218811, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:28 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:53:28 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717207.964797, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 7.7, 'memory_percent': 75.7}} from 28830870, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:28 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:53:31 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 99218811, 'timestamp': 1770717210.3349912, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 4.5, 'memory_percent': 75.5}} from 99218811, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:31 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:53:31 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717210.9629672, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 5.8, 'memory_percent': 75.8}} from 28830870, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:31 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:53:33 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:53:33 [election] [WARNING] [I'm Follower - (28830870, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:53:33 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Election started; peers=[45924667, 99218811, 989798494]
10:53:33 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Challenging higher peers: [45924667, 99218811, 989798494]
10:53:33 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:53:33 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.4:9003
10:53:33 [election] [DEBUG] [I'm Election - (28830870, 127.0.0.2)] UDP send ELECTION -> 127.0.0.5:9003
10:53:33 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] Challenged by 99218811, sending ANSWER to 127.0.0.4
10:53:34 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:53:34 [fault_detection] [INFO] Election already in progress, skipping trigger
10:53:34 [network_manager] [ERROR] No connection found for 989798494, cannot send message
10:53:36 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:53:36 [fault_detection] [INFO] Election already in progress, skipping trigger
10:53:36 [election] [INFO] [I'm Election - (28830870, 127.0.0.2)] No ANSWER received, becoming Leader
10:53:36 [server_role] [DEBUG] Closed connection to old leader 99218811
10:53:36 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717216.960851, 'identity': 'LEADER'}
10:53:36 [network_manager] [DEBUG] there are currently 1 followers to send to: [28830870]
10:53:37 [membership] [INFO] server 28830870 assigned to group group_0
10:53:37 [membership] [INFO] Leader initialized with server info: {'server_id': 28830870, 'load_info': {'cpu_percent': 7.0, 'memory_percent': 75.9}, 'address': '127.0.0.2'}
10:53:37 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:53:37 [network_manager] [DEBUG] Leader long-lived connection listener started
10:53:37 [server_role] [INFO] [Leader] Notifying followers about new leader: 28830870
10:53:37 [server_role] [INFO] [Leader] Notified follower 99218811 at 127.0.0.4 about new leader
10:53:37 [server_role] [INFO] [Leader] Notified follower 989798494 at 127.0.0.5 about new leader
10:53:37 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 28830870, 'timestamp': 1770717217.797718, 'identity': 'LEADER'}
10:53:37 [network_manager] [DEBUG] there are currently 1 followers to send to: [28830870]
10:53:37 [network_manager] [DEBUG] Failed to send message to follower 28830870, unregistering: [Errno 32] Broken pipe
10:53:37 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:53:37 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:53:37 [election] [DEBUG] [I'm Leader - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:37 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:37 [election] [INFO] [I'm Leader - (28830870, 127.0.0.2)] Demoting to Follower, new Leader: 989798494
10:53:37 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.5...
10:53:37 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.5
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:37 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:37 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:38 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:38 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:38 [election] [DEBUG] [I'm Follower - (28830870, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 99218811 (127.0.0.4)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 99218811
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Received COORDINATOR from 989798494 (127.0.0.5)
10:53:38 [election] [INFO] [I'm Follower - (28830870, 127.0.0.2)] Reset leader heartbeat timer for new leader 989798494
10:53:40 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 989798494, 'timestamp': 1770717220.936886, 'identity': 'LEADER'} from 989798494, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:46 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 989798494, 'timestamp': 1770717226.9396648, 'identity': 'LEADER'} from 989798494, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:49 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 989798494, 'timestamp': 1770717229.9361222, 'identity': 'LEADER'} from 989798494, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
10:53:52 [server.heartbeat] [DEBUG] [I'm Follower - 28830870] Heartbeat received message: HEARTBEAT {'server_id': 989798494, 'timestamp': 1770717232.937103, 'identity': 'LEADER'} from 989798494, current memnershiplist is {28830870: '127.0.0.2', 99218811: '127.0.0.4', 989798494: '127.0.0.5'}
