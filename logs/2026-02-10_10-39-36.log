10:39:36 [root] [INFO] 日志系统初始化完成。文件保存至: logs/2026-02-10_10-39-36.log
10:39:38 [utills.ip_validator] [DEBUG] IP 127.0.0.2 是回环地址（本地测试用）
10:39:39 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Election Manager starting
10:39:39 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] UDP listener started on UDP:9003
10:39:39 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 307279263 (127.0.0.1)
10:39:39 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 307279263 (127.0.0.1)
10:39:39 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 307279263 (127.0.0.1)
10:39:40 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.1...
10:39:40 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.1
10:39:48 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 307279263, 'timestamp': 1770716388.758347, 'identity': 'LEADER'} from 307279263, current memnershiplist is {406379425: '127.0.0.2', 307279263: '127.0.0.1'}
10:39:49 [server_role] [INFO] [Follower] New follower joined: 413601419 with IP: 127.0.0.3. Updated membership list: {406379425: '127.0.0.2', 307279263: '127.0.0.1', 413601419: '127.0.0.3'}
10:40:10 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:40:10 [election] [WARNING] [I'm Follower - (406379425, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:40:10 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Election started; peers=[307279263, 413601419]
10:40:10 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Challenging higher peers: [413601419]
10:40:10 [election] [DEBUG] [I'm Election - (406379425, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:40:10 [server_role] [DEBUG] Closed old connection to 413601419
10:40:10 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:40:10 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:40:10 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:10 [server_role] [INFO] Reconnected to new leader 413601419 at 127.0.0.3
10:40:10 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Demoting to Follower, new Leader: 413601419
10:40:10 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:10 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:15 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:40:15 [election] [WARNING] [I'm Follower - (406379425, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:40:15 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Election started; peers=[307279263, 413601419]
10:40:15 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Challenging higher peers: [413601419]
10:40:15 [election] [DEBUG] [I'm Election - (406379425, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:40:17 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] No ANSWER received, becoming Leader
10:40:17 [server_role] [DEBUG] Closed connection to old leader 307279263
10:40:18 [membership] [INFO] server 406379425 assigned to group group_0
10:40:18 [membership] [INFO] Leader initialized with server info: {'server_id': 406379425, 'load_info': {'cpu_percent': 12.1, 'memory_percent': 81.6}, 'address': '127.0.0.2'}
10:40:18 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:40:18 [network_manager] [DEBUG] Leader long-lived connection listener started
10:40:18 [server_role] [INFO] [Leader] Notifying followers about new leader: 406379425
10:40:18 [server_role] [INFO] [Leader] Notified follower 307279263 at 127.0.0.1 about new leader
10:40:18 [server_role] [INFO] [Leader] Notified follower 413601419 at 127.0.0.3 about new leader
10:40:18 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:40:18 [election] [DEBUG] [I'm Leader - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:18 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:18 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Demoting to Follower, new Leader: 413601419
10:40:18 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:40:18 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:40:18 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:18 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:18 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:18 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:20 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:40:20 [election] [WARNING] [I'm Follower - (406379425, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:40:20 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Election started; peers=[307279263, 413601419]
10:40:20 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Challenging higher peers: [413601419]
10:40:20 [election] [DEBUG] [I'm Election - (406379425, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:40:21 [network_manager] [ERROR] No connection found for 413601419, cannot send message
10:40:22 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] No ANSWER received, becoming Leader
10:40:22 [server_role] [DEBUG] Closed connection to old leader 307279263
10:40:23 [membership] [INFO] server 406379425 assigned to group group_0
10:40:23 [membership] [INFO] Leader initialized with server info: {'server_id': 406379425, 'load_info': {'cpu_percent': 4.5, 'memory_percent': 81.1}, 'address': '127.0.0.2'}
10:40:23 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:40:23 [network_manager] [DEBUG] Leader long-lived connection listener started
10:40:23 [server_role] [INFO] [Leader] Notifying followers about new leader: 406379425
10:40:23 [server_role] [INFO] [Leader] Notified follower 307279263 at 127.0.0.1 about new leader
10:40:23 [server_role] [INFO] [Leader] Notified follower 413601419 at 127.0.0.3 about new leader
10:40:23 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:40:23 [election] [DEBUG] [I'm Leader - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:23 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:23 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Demoting to Follower, new Leader: 413601419
10:40:23 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:40:23 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:40:23 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:23 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:23 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:23 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:25 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:40:25 [election] [WARNING] [I'm Follower - (406379425, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:40:25 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Election started; peers=[307279263, 413601419]
10:40:25 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Challenging higher peers: [413601419]
10:40:25 [election] [DEBUG] [I'm Election - (406379425, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:40:27 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] No ANSWER received, becoming Leader
10:40:27 [server_role] [DEBUG] Closed connection to old leader 307279263
10:40:28 [membership] [INFO] server 406379425 assigned to group group_0
10:40:28 [membership] [INFO] Leader initialized with server info: {'server_id': 406379425, 'load_info': {'cpu_percent': 4.6, 'memory_percent': 81.2}, 'address': '127.0.0.2'}
10:40:28 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:40:28 [network_manager] [DEBUG] Leader long-lived connection listener started
10:40:28 [server_role] [INFO] [Leader] Notifying followers about new leader: 406379425
10:40:28 [server_role] [INFO] [Leader] Notified follower 307279263 at 127.0.0.1 about new leader
10:40:28 [server_role] [INFO] [Leader] Notified follower 413601419 at 127.0.0.3 about new leader
10:40:28 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:40:28 [election] [DEBUG] [I'm Leader - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:28 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:28 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Demoting to Follower, new Leader: 413601419
10:40:28 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:40:28 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:40:28 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:28 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:28 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:28 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:30 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:40:30 [election] [WARNING] [I'm Follower - (406379425, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:40:30 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Election started; peers=[307279263, 413601419]
10:40:30 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Challenging higher peers: [413601419]
10:40:30 [election] [DEBUG] [I'm Election - (406379425, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:40:31 [network_manager] [ERROR] No connection found for 413601419, cannot send message
10:40:32 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] No ANSWER received, becoming Leader
10:40:32 [server_role] [DEBUG] Closed connection to old leader 307279263
10:40:33 [membership] [INFO] server 406379425 assigned to group group_1
10:40:33 [membership] [INFO] Leader initialized with server info: {'server_id': 406379425, 'load_info': {'cpu_percent': 6.5, 'memory_percent': 81.7}, 'address': '127.0.0.2'}
10:40:33 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:40:33 [network_manager] [DEBUG] Leader long-lived connection listener started
10:40:33 [server_role] [INFO] [Leader] Notifying followers about new leader: 406379425
10:40:33 [server_role] [INFO] [Leader] Notified follower 307279263 at 127.0.0.1 about new leader
10:40:33 [server_role] [INFO] [Leader] Notified follower 413601419 at 127.0.0.3 about new leader
10:40:33 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:40:33 [election] [DEBUG] [I'm Leader - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:33 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:33 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Demoting to Follower, new Leader: 413601419
10:40:33 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:40:33 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:40:33 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:33 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:33 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:33 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:35 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:40:35 [election] [WARNING] [I'm Follower - (406379425, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:40:35 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Election started; peers=[307279263, 413601419]
10:40:35 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Challenging higher peers: [413601419]
10:40:35 [election] [DEBUG] [I'm Election - (406379425, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:40:37 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] No ANSWER received, becoming Leader
10:40:37 [server_role] [DEBUG] Closed connection to old leader 307279263
10:40:38 [membership] [INFO] server 406379425 assigned to group group_0
10:40:38 [membership] [INFO] Leader initialized with server info: {'server_id': 406379425, 'load_info': {'cpu_percent': 5.6, 'memory_percent': 81.2}, 'address': '127.0.0.2'}
10:40:38 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:40:38 [network_manager] [DEBUG] Leader long-lived connection listener started
10:40:38 [server_role] [INFO] [Leader] Notifying followers about new leader: 406379425
10:40:38 [server_role] [INFO] [Leader] Notified follower 307279263 at 127.0.0.1 about new leader
10:40:38 [server_role] [INFO] [Leader] Notified follower 413601419 at 127.0.0.3 about new leader
10:40:38 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:40:38 [election] [DEBUG] [I'm Leader - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:38 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:38 [election] [INFO] [I'm Leader - (406379425, 127.0.0.2)] Demoting to Follower, new Leader: 413601419
10:40:38 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:40:38 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:40:38 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:38 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:38 [election] [DEBUG] [I'm Follower - (406379425, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:40:38 [election] [INFO] [I'm Follower - (406379425, 127.0.0.2)] Received COORDINATOR from 413601419 (127.0.0.3)
10:40:39 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 413601419, 'timestamp': 1770716439.387915, 'identity': 'LEADER'} from 413601419, current memnershiplist is {406379425: '127.0.0.2', 307279263: '127.0.0.1', 413601419: '127.0.0.3'}
10:41:00 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:41:00 [election] [WARNING] [I'm Follower - (406379425, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:41:00 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Election started; peers=[307279263, 413601419]
10:41:00 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] Challenging higher peers: [413601419]
10:41:00 [election] [DEBUG] [I'm Election - (406379425, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:41:01 [network_manager] [ERROR] No connection found for 413601419, cannot send message
10:41:02 [election] [INFO] [I'm Election - (406379425, 127.0.0.2)] No ANSWER received, becoming Leader
10:41:02 [server_role] [DEBUG] Closed connection to old leader 307279263
