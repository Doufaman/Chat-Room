10:55:56 [root] [INFO] 日志系统初始化完成。文件保存至: logs/2026-02-10_10-55-56.log
10:55:58 [utills.ip_validator] [DEBUG] IP 127.0.0.2 是回环地址（本地测试用）
10:55:58 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Election Manager starting
10:55:58 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] UDP listener started on UDP:9003
10:55:59 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.1...
10:55:59 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.1
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 270804158 (127.0.0.1)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Accepting COORDINATOR from 270804158 (no current leader)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 270804158 (127.0.0.1)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Accepting COORDINATOR from 270804158 (no current leader)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 270804158 (127.0.0.1)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Accepting COORDINATOR from 270804158 (no current leader)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 270804158 (127.0.0.1)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Accepting COORDINATOR from 270804158 (no current leader)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 270804158 (127.0.0.1)
10:56:00 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Accepting COORDINATOR from 270804158 (no current leader)
10:56:02 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 270804158, 'timestamp': 1770717362.125323, 'identity': 'LEADER'} from 270804158, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1'}
10:56:03 [server_role] [INFO] [Follower] New follower joined: 606035513 with IP: 127.0.0.3. Updated membership list: {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3'}
10:56:05 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 270804158, 'timestamp': 1770717365.1251872, 'identity': 'LEADER'} from 270804158, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3'}
10:56:07 [server_role] [INFO] [Follower] New follower joined: 974668429 with IP: 127.0.0.4. Updated membership list: {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:07 [server_role] [INFO] Received STEAL_NOTIFICATION: stolen_server=606035513, stolen_group_id=group_0, new_group_id=group_1, new_group_member={'974668429': '127.0.0.4'}
10:56:07 [server_role] [INFO] Updated group info: group_id=group_0, group_members={'270804158': '127.0.0.1'}
10:56:08 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 270804158, 'timestamp': 1770717368.1222222, 'identity': 'LEADER'} from 270804158, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:11 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 270804158, 'timestamp': 1770717371.124353, 'identity': 'LEADER'} from 270804158, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:14 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 270804158, 'timestamp': 1770717374.125303, 'identity': 'LEADER'} from 270804158, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:21 [server.heartbeat] [ERROR] [I'm Follower - 581012865] Failed to send heartbeat to leader 270804158: [Errno 32] Broken pipe
10:56:24 [network_manager] [ERROR] No connection found for 270804158, cannot send message
10:56:25 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Challenged by 606035513, sending ANSWER to 127.0.0.3
10:56:25 [election] [WARNING] [I'm Follower - (581012865, 127.0.0.2)] Election triggered: Challenged by lower node
10:56:25 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:56:25 [fault_detection] [INFO] Election already in progress, skipping trigger
10:56:25 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Election started; peers=[270804158, 606035513, 974668429]
10:56:25 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenging higher peers: [606035513, 974668429]
10:56:25 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:56:25 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.4:9003
10:56:25 [server_role] [DEBUG] Closed old connection to 974668429
10:56:25 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.4...
10:56:25 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.4
10:56:25 [server_role] [INFO] Reconnected to new leader 974668429 at 127.0.0.4
10:56:25 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Received COORDINATOR from 974668429 (127.0.0.4)
10:56:25 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] In ELECTION, accepting first COORDINATOR from 974668429
10:56:25 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Reset leader heartbeat timer for new leader 974668429
10:56:26 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 974668429 (127.0.0.4)
10:56:26 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 974668429 (127.0.0.4)
10:56:26 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 974668429 (127.0.0.4)
10:56:26 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 974668429 (127.0.0.4)
10:56:28 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717388.918526, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:31 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717391.918001, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:34 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717394.917048, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:37 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717397.915976, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 270804158: '127.0.0.1', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:39 [server_role] [INFO] [Follower] Server removed: 270804158 from group None. Updated membership list: {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:40 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717400.918858, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:43 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717403.9169888, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:46 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717406.9188428, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:49 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717409.914127, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:52 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717412.9158049, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:55 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717415.917312, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:56:58 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717418.914887, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:01 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717421.915067, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:04 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717424.917074, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:07 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717427.917494, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:10 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717430.9139159, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:13 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717433.9157581, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:16 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 974668429, 'timestamp': 1770717436.9180942, 'identity': 'LEADER'} from 974668429, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:24 [server.heartbeat] [ERROR] [I'm Follower - 581012865] Failed to send heartbeat to leader 974668429: [Errno 32] Broken pipe
10:57:25 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Challenged by 606035513, sending ANSWER to 127.0.0.3
10:57:25 [election] [WARNING] [I'm Follower - (581012865, 127.0.0.2)] Election triggered: Challenged by lower node
10:57:25 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Election started; peers=[606035513, 974668429]
10:57:25 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenging higher peers: [606035513, 974668429]
10:57:25 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:57:25 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.4:9003
10:57:26 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:57:26 [fault_detection] [INFO] Election already in progress, skipping trigger
10:57:27 [network_manager] [ERROR] No connection found for 974668429, cannot send message
10:57:28 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:57:28 [fault_detection] [INFO] Election already in progress, skipping trigger
10:57:28 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] No ANSWER received, becoming Leader
10:57:28 [server_role] [DEBUG] Closed connection to old leader 606035513
10:57:29 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [membership] [INFO] server 581012865 assigned to group group_0
10:57:29 [membership] [INFO] Leader initialized with server info: {'server_id': 581012865, 'load_info': {'cpu_percent': 5.3, 'memory_percent': 76.0}, 'address': '127.0.0.2'}
10:57:29 [membership] [INFO] server added: 606035513
10:57:29 [server_role] [INFO] [Leader] Initialized server 606035513 in membership
10:57:29 [membership] [INFO] server added: 974668429
10:57:29 [server_role] [INFO] [Leader] Initialized server 974668429 in membership
10:57:29 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:57:29 [network_manager] [DEBUG] Leader long-lived connection listener started
10:57:29 [server_role] [INFO] [Leader] Notifying followers about new leader: 581012865
10:57:29 [server_role] [INFO] [Leader] Notified follower 606035513 at 127.0.0.3 about new leader
10:57:29 [server_role] [INFO] [Leader] Notified follower 974668429 at 127.0.0.4 about new leader
10:57:29 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 581012865, 'timestamp': 1770717449.481646, 'identity': 'LEADER'}
10:57:29 [network_manager] [DEBUG] there are currently 0 followers to send to: []
10:57:29 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:57:29 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:57:29 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Demoting to Follower, new Leader: 606035513
10:57:29 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:57:29 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
10:57:29 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:29 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:57:29 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:30 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:57:30 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 606035513 (127.0.0.3)
10:57:30 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717450.4057128, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:33 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717453.4056919, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:36 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717456.40506, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:39 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717459.4056919, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4'}
10:57:41 [server_role] [INFO] [Follower] New follower joined: 774390020 with IP: 127.0.0.4. Updated membership list: {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4', 774390020: '127.0.0.4'}
10:57:42 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717462.402817, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 974668429: '127.0.0.4', 774390020: '127.0.0.4'}
10:57:42 [server_role] [INFO] [Follower] Server removed: 974668429 from group None. Updated membership list: {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4'}
10:57:48 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717468.40336, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4'}
10:57:50 [server_role] [INFO] [Follower] New follower joined: 507043040 with IP: 127.0.0.5. Updated membership list: {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 507043040: '127.0.0.5'}
10:57:54 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717474.4056818, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 507043040: '127.0.0.5'}
10:57:57 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717477.404854, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 507043040: '127.0.0.5'}
10:58:00 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717480.404842, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 507043040: '127.0.0.5'}
10:58:02 [server_role] [INFO] [Follower] New follower joined: 227448053 with IP: 127.0.0.4. Updated membership list: {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 507043040: '127.0.0.5', 227448053: '127.0.0.4'}
10:58:03 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 606035513, 'timestamp': 1770717483.401379, 'identity': 'LEADER'} from 606035513, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 507043040: '127.0.0.5', 227448053: '127.0.0.4'}
10:58:07 [server_role] [INFO] [Follower] Server removed: 507043040 from group group_1. Updated membership list: {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:12 [server.heartbeat] [ERROR] [I'm Follower - 581012865] Failed to send heartbeat to leader 606035513: [Errno 32] Broken pipe
10:58:13 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:58:13 [election] [WARNING] [I'm Follower - (581012865, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:58:13 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Election started; peers=[606035513, 774390020, 227448053]
10:58:13 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenging higher peers: [606035513, 774390020]
10:58:13 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:58:13 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.4:9003
10:58:15 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:58:15 [fault_detection] [INFO] Election already in progress, skipping trigger
10:58:15 [network_manager] [ERROR] No connection found for 606035513, cannot send message
10:58:16 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:58:16 [fault_detection] [INFO] Election already in progress, skipping trigger
10:58:16 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] No ANSWER received, becoming Leader
10:58:16 [server_role] [DEBUG] Closed connection to old leader 606035513
10:58:17 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 581012865, 'timestamp': 1770717497.7059789, 'identity': 'LEADER'}
10:58:17 [network_manager] [DEBUG] there are currently 0 followers to send to: []
10:58:17 [membership] [INFO] server 581012865 assigned to group group_0
10:58:17 [membership] [INFO] Leader initialized with server info: {'server_id': 581012865, 'load_info': {'cpu_percent': 4.7, 'memory_percent': 75.8}, 'address': '127.0.0.2'}
10:58:17 [membership] [INFO] server added: 774390020
10:58:17 [server_role] [INFO] [Leader] Initialized server 774390020 in membership
10:58:17 [membership] [INFO] server added: 227448053
10:58:17 [server_role] [INFO] [Leader] Initialized server 227448053 in membership
10:58:17 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:58:17 [network_manager] [DEBUG] Leader long-lived connection listener started
10:58:17 [server_role] [INFO] [Leader] Notifying followers about new leader: 581012865
10:58:17 [server_role] [INFO] [Leader] Notified follower 606035513 at 127.0.0.3 about new leader
10:58:17 [server_role] [INFO] [Leader] Notified follower 774390020 at 127.0.0.4 about new leader
10:58:17 [server_role] [INFO] [Leader] Notified follower 227448053 at 127.0.0.4 about new leader
10:58:17 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 581012865, 'timestamp': 1770717497.815678, 'identity': 'LEADER'}
10:58:17 [network_manager] [DEBUG] there are currently 0 followers to send to: []
10:58:17 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:58:17 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:58:17 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:17 [network_manager] [DEBUG] Registered long-lived connection from follower 227448053 at ('127.0.0.2', 63155)
10:58:17 [network_manager] [DEBUG] Registered long-lived connection from follower 227448053 at ('127.0.0.2', 63156)
10:58:17 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:18 [membership] [INFO] server 606035513 status changed: ACTIVE -> SUSPECT
10:58:18 [membership] [INFO] server 974668429 status changed: ACTIVE -> SUSPECT
10:58:18 [fault_detection] [INFO] Suspected servers: [606035513, 974668429]. Sending probes.
10:58:18 [network_manager] [ERROR] No connection found for 606035513, cannot send message
10:58:18 [network_manager] [ERROR] No connection found for 974668429, cannot send message
10:58:18 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:18 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:18 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:18 [server.heartbeat] [DEBUG] [I'm Leader - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 227448053, 'timestamp': 1770717497.799555, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 7.6, 'memory_percent': 76.0}} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:18 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:18 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Demoting to Follower, new Leader: 774390020
10:58:18 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.4...
10:58:18 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.4
10:58:18 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:18 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:18 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:18 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:18 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:18 [network_manager] [DEBUG] Registered long-lived connection from follower 581012865 at ('127.0.0.4', 63160)
10:58:18 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:19 [membership] [ERROR] illegal operation (not leader)
10:58:19 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:19 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:19 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:21 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 227448053, 'timestamp': 1770717500.799555, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 5.6, 'memory_percent': 75.9}} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:21 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:58:24 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 581012865, 'timestamp': 1770717503.706439, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 6.5, 'memory_percent': 76.0}} from 581012865, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:24 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:58:24 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 227448053, 'timestamp': 1770717503.7995489, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 6.1, 'memory_percent': 76.0}} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:24 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:58:27 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 227448053, 'timestamp': 1770717506.79864, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 4.9, 'memory_percent': 76.1}} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:27 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
10:58:29 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:58:29 [election] [WARNING] [I'm Follower - (581012865, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:58:29 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Election started; peers=[606035513, 774390020, 227448053]
10:58:29 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenging higher peers: [606035513, 774390020]
10:58:29 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:58:29 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.4:9003
10:58:30 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenged by 227448053, sending ANSWER to 127.0.0.4
10:58:30 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenged by 227448053, sending ANSWER to 127.0.0.4
10:58:30 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenged by 227448053, sending ANSWER to 127.0.0.4
10:58:30 [network_manager] [ERROR] No connection found for 774390020, cannot send message
10:58:31 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:58:31 [fault_detection] [INFO] Election already in progress, skipping trigger
10:58:32 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:58:32 [fault_detection] [INFO] Election already in progress, skipping trigger
10:58:32 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] No ANSWER received, becoming Leader
10:58:32 [server_role] [DEBUG] Closed connection to old leader 606035513
10:58:33 [membership] [INFO] server 581012865 assigned to group group_0
10:58:33 [membership] [INFO] Leader initialized with server info: {'server_id': 581012865, 'load_info': {'cpu_percent': 6.0, 'memory_percent': 76.0}, 'address': '127.0.0.2'}
10:58:33 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:58:33 [network_manager] [DEBUG] Leader long-lived connection listener started
10:58:33 [server_role] [INFO] [Leader] Notifying followers about new leader: 581012865
10:58:33 [server_role] [INFO] [Leader] Notified follower 606035513 at 127.0.0.3 about new leader
10:58:33 [server_role] [INFO] [Leader] Notified follower 774390020 at 127.0.0.4 about new leader
10:58:33 [server_role] [INFO] [Leader] Notified follower 227448053 at 127.0.0.4 about new leader
10:58:33 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 581012865, 'timestamp': 1770717513.8493812, 'identity': 'LEADER'}
10:58:33 [network_manager] [DEBUG] there are currently 2 followers to send to: [227448053, 581012865]
10:58:33 [network_manager] [DEBUG] Failed to send message to follower 581012865, unregistering: [Errno 32] Broken pipe
10:58:33 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:58:33 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:58:33 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:33 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:33 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Demoting to Follower, new Leader: 774390020
10:58:33 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.4...
10:58:33 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.4
10:58:34 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:34 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:34 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:34 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:34 [server_role] [DEBUG] Closed old connection to 227448053
10:58:34 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.4...
10:58:34 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.4
10:58:34 [server_role] [INFO] Reconnected to new leader 227448053 at 127.0.0.4
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 227448053 (127.0.0.4)
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 227448053 (127.0.0.4)
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 227448053 (127.0.0.4)
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 227448053 (127.0.0.4)
10:58:34 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:35 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 227448053 (127.0.0.4)
10:58:35 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:58:35 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717515.400678, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:38 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717518.401437, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:41 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717521.40193, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:44 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717524.3982458, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:47 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717527.397887, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:53 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717533.400788, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:56 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717536.4018922, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:58:59 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717539.4009228, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:02 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717542.40193, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:05 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717545.398682, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:08 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717548.401938, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:11 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717551.401679, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:14 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717554.401929, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:17 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717557.399644, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:20 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717560.398905, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:23 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717563.399134, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:26 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717566.397579, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:29 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717569.400008, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:32 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717572.399945, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:35 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717575.3981261, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:38 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717578.401451, 'identity': 'LEADER'} from 227448053, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
10:59:49 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:59:49 [election] [WARNING] [I'm Follower - (581012865, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:59:49 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Election started; peers=[606035513, 774390020, 227448053]
10:59:49 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] Challenging higher peers: [606035513, 774390020]
10:59:49 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.3:9003
10:59:49 [election] [DEBUG] [I'm Election - (581012865, 127.0.0.2)] UDP send ELECTION -> 127.0.0.4:9003
10:59:50 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:59:50 [fault_detection] [INFO] Election already in progress, skipping trigger
10:59:51 [network_manager] [ERROR] No connection found for 227448053, cannot send message
10:59:52 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:59:52 [fault_detection] [INFO] Election already in progress, skipping trigger
10:59:52 [election] [INFO] [I'm Election - (581012865, 127.0.0.2)] No ANSWER received, becoming Leader
10:59:52 [server_role] [DEBUG] Closed connection to old leader 606035513
10:59:53 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 581012865, 'timestamp': 1770717593.706004, 'identity': 'LEADER'}
10:59:53 [network_manager] [DEBUG] there are currently 1 followers to send to: [774390020]
10:59:53 [membership] [INFO] server 581012865 assigned to group group_1
10:59:53 [membership] [INFO] Leader initialized with server info: {'server_id': 581012865, 'load_info': {'cpu_percent': 8.6, 'memory_percent': 76.6}, 'address': '127.0.0.2'}
10:59:53 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:59:53 [network_manager] [DEBUG] Leader long-lived connection listener started
10:59:53 [server_role] [INFO] [Leader] Notifying followers about new leader: 581012865
10:59:53 [server_role] [INFO] [Leader] Notified follower 606035513 at 127.0.0.3 about new leader
10:59:53 [server_role] [INFO] [Leader] Notified follower 774390020 at 127.0.0.4 about new leader
10:59:53 [server_role] [INFO] [Leader] Notified follower 227448053 at 127.0.0.4 about new leader
10:59:53 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 581012865, 'timestamp': 1770717593.7339451, 'identity': 'LEADER'}
10:59:53 [network_manager] [DEBUG] there are currently 1 followers to send to: [774390020]
10:59:53 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:59:53 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:59:53 [election] [DEBUG] [I'm Leader - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:59:53 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:59:53 [election] [INFO] [I'm Leader - (581012865, 127.0.0.2)] Demoting to Follower, new Leader: 774390020
10:59:53 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.4...
10:59:53 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.4
10:59:53 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:59:53 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:59:54 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:59:54 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:59:54 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:59:54 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:59:54 [election] [DEBUG] [I'm Follower - (581012865, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:59:54 [election] [INFO] [I'm Follower - (581012865, 127.0.0.2)] Received COORDINATOR from 774390020 (127.0.0.4)
10:59:56 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717596.4019258, 'identity': 'LEADER'} from 774390020, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
11:00:02 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717602.4017851, 'identity': 'LEADER'} from 774390020, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
11:00:05 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717605.403838, 'identity': 'LEADER'} from 774390020, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
11:00:08 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717608.397435, 'identity': 'LEADER'} from 774390020, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
11:00:11 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717611.401922, 'identity': 'LEADER'} from 774390020, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
11:00:14 [server.heartbeat] [DEBUG] [I'm Follower - 581012865] Heartbeat received message: HEARTBEAT {'server_id': 774390020, 'timestamp': 1770717614.398564, 'identity': 'LEADER'} from 774390020, current memnershiplist is {581012865: '127.0.0.2', 606035513: '127.0.0.3', 774390020: '127.0.0.4', 227448053: '127.0.0.4'}
