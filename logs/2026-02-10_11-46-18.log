11:46:18 [root] [INFO] 日志系统初始化完成。文件保存至: logs/2026-02-10_11-46-18.log
11:46:20 [utills.ip_validator] [DEBUG] IP 127.0.0.1 是回环地址（本地测试用）
11:46:27 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Election Manager starting
11:46:27 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] UDP listener started on UDP:9003
11:46:28 [membership] [INFO] server 908737562 assigned to group group_0
11:46:28 [membership] [INFO] Leader initialized with server info: {'server_id': 908737562, 'load_info': {'cpu_percent': 8.5, 'memory_percent': 80.1}, 'address': '127.0.0.1'}
11:46:28 [network_manager] [DEBUG] Starting leader long-lived connection listener...
11:46:28 [network_manager] [DEBUG] Leader long-lived connection listener started
11:46:28 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 908737562, 'timestamp': 1770720388.4116108, 'identity': 'LEADER'}
11:46:28 [network_manager] [DEBUG] there are currently 0 followers to send to: []
11:46:28 [election] [WARNING] [I'm Leader - (908737562, 127.0.0.1)] Election triggered: First server startup
11:46:29 [election] [INFO] [I'm Election - (908737562, 127.0.0.1)] Election started; peers=[]
11:46:29 [election] [INFO] [I'm Election - (908737562, 127.0.0.1)] No higher peers, becoming Leader
11:46:29 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Broadcasting COORDINATOR (victory)
11:46:29 [election] [DEBUG] [I'm Leader - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:46:29 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:46:29 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Demoting to Follower, new Leader: 929583631
11:46:29 [membership] [ERROR] illegal operation (not leader)
11:46:29 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:46:29 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:46:29 [network_manager] [DEBUG] Registered long-lived connection from follower 929583631 at ('127.0.0.1', 64156)
11:46:29 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:46:30 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:46:31 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720391.923826, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:32 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:46:32 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:46:32 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720392.3968, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:32 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:46:32 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:46:33 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:46:33 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:46:34 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720394.927329, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:37 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720397.9229388, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:40 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720400.927341, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:43 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720403.925235, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:46 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720406.924534, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:49 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720409.927371, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:52 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720412.9266639, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:55 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720415.927337, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:46:58 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720418.922923, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:01 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720421.924858, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:04 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720424.9272199, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:07 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720427.927318, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:10 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720430.92674, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:13 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720433.927331, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:15 [network_manager] [DEBUG] Registered long-lived connection from follower 821697342 at ('127.0.0.2', 64182)
11:47:16 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720436.926721, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:16 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 821697342, 'timestamp': 1770720435.9283268, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 10.0, 'memory_percent': 79.4}} from 821697342, current memnershiplist is {908737562: '127.0.0.1'}
11:47:16 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
11:47:19 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720439.925924, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:19 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 821697342, 'timestamp': 1770720438.9333298, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 4.8, 'memory_percent': 78.8}} from 821697342, current memnershiplist is {908737562: '127.0.0.1'}
11:47:19 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
11:47:22 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720442.9273229, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:22 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 821697342, 'timestamp': 1770720441.933388, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 4.7, 'memory_percent': 78.9}} from 821697342, current memnershiplist is {908737562: '127.0.0.1'}
11:47:22 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
11:47:25 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720445.922656, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:25 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 821697342, 'timestamp': 1770720444.929306, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 7.2, 'memory_percent': 78.9}} from 821697342, current memnershiplist is {908737562: '127.0.0.1'}
11:47:25 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
11:47:28 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720448.927319, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:28 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 821697342, 'timestamp': 1770720447.929586, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 7.1, 'memory_percent': 79.0}} from 821697342, current memnershiplist is {908737562: '127.0.0.1'}
11:47:28 [fault_detection] [WARNING] Received heartbeat from unexpected identity FOLLOWER while being FOLLOWER
11:47:31 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Challenged by 821697342, sending ANSWER to 127.0.0.3
11:47:31 [election] [WARNING] [I'm Follower - (908737562, 127.0.0.1)] Election triggered: Challenged by lower node
11:47:31 [election] [INFO] [I'm Election - (908737562, 127.0.0.1)] Election started; peers=[]
11:47:31 [election] [INFO] [I'm Election - (908737562, 127.0.0.1)] No higher peers, becoming Leader
11:47:31 [server.heartbeat] [DEBUG] [I'm Leader - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720451.927329, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:31 [fault_detection] [WARNING] Received heartbeat from unexpected identity LEADER while being LEADER
11:47:32 [network_manager] [ERROR] No connection found for 908737562, cannot send message
11:47:32 [membership] [INFO] server 908737562 assigned to group group_0
11:47:32 [membership] [INFO] Leader initialized with server info: {'server_id': 908737562, 'load_info': {'cpu_percent': 5.1, 'memory_percent': 79.2}, 'address': '127.0.0.1'}
11:47:32 [network_manager] [DEBUG] Starting leader long-lived connection listener...
11:47:32 [network_manager] [DEBUG] Leader long-lived connection listener started
11:47:32 [server_role] [INFO] [Leader] Notifying followers about new leader: 908737562
11:47:32 [server_role] [INFO] [Leader] Waiting for followers to connect...
11:47:34 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 908737562, 'timestamp': 1770720454.311866, 'identity': 'LEADER'}
11:47:34 [network_manager] [DEBUG] there are currently 2 followers to send to: [929583631, 821697342]
11:47:34 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
11:47:34 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Broadcasting COORDINATOR (victory)
11:47:34 [election] [DEBUG] [I'm Leader - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:34 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:34 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Demoting to Follower, new Leader: 929583631
11:47:34 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:34 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:34 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:34 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:34 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:34 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720454.926574, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:34 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:35 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:35 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:37 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720457.927328, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:40 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720460.925028, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:43 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720463.9248052, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:46 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720466.927318, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:49 [server.heartbeat] [DEBUG] [I'm Follower - 908737562] Heartbeat received message: HEARTBEAT {'server_id': 929583631, 'timestamp': 1770720469.926291, 'identity': 'LEADER'} from 929583631, current memnershiplist is {908737562: '127.0.0.1'}
11:47:50 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Challenged by 821697342, sending ANSWER to 127.0.0.3
11:47:50 [election] [WARNING] [I'm Follower - (908737562, 127.0.0.1)] Election triggered: Challenged by lower node
11:47:51 [election] [INFO] [I'm Election - (908737562, 127.0.0.1)] Election started; peers=[]
11:47:51 [election] [INFO] [I'm Election - (908737562, 127.0.0.1)] No higher peers, becoming Leader
11:47:52 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 908737562, 'timestamp': 1770720472.416606, 'identity': 'LEADER'}
11:47:52 [network_manager] [DEBUG] there are currently 2 followers to send to: [929583631, 821697342]
11:47:52 [network_manager] [DEBUG] Failed to send message to follower 821697342, unregistering: [Errno 32] Broken pipe
11:47:52 [membership] [INFO] server 908737562 assigned to group group_0
11:47:52 [membership] [INFO] Leader initialized with server info: {'server_id': 908737562, 'load_info': {'cpu_percent': 9.0, 'memory_percent': 79.2}, 'address': '127.0.0.1'}
11:47:52 [network_manager] [DEBUG] Starting leader long-lived connection listener...
11:47:52 [network_manager] [DEBUG] Leader long-lived connection listener started
11:47:52 [server_role] [INFO] [Leader] Notifying followers about new leader: 908737562
11:47:52 [server_role] [INFO] [Leader] Waiting for followers to connect...
11:47:54 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 908737562, 'timestamp': 1770720474.06949, 'identity': 'LEADER'}
11:47:54 [network_manager] [DEBUG] there are currently 1 followers to send to: [929583631]
11:47:54 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
11:47:54 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Broadcasting COORDINATOR (victory)
11:47:54 [election] [DEBUG] [I'm Leader - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:54 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:54 [election] [INFO] [I'm Leader - (908737562, 127.0.0.1)] Demoting to Follower, new Leader: 929583631
11:47:54 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:54 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:54 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:54 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:54 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:54 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
11:47:54 [election] [DEBUG] [I'm Follower - (908737562, 127.0.0.1)] UDP send COORDINATOR -> <broadcast>:9003
11:47:54 [election] [INFO] [I'm Follower - (908737562, 127.0.0.1)] Received COORDINATOR from 929583631 (127.0.0.2)
