10:39:43 [root] [INFO] 日志系统初始化完成。文件保存至: logs/2026-02-10_10-39-43.log
10:39:47 [utills.ip_validator] [DEBUG] IP 127.0.0.3 是回环地址（本地测试用）
10:39:48 [election] [INFO] [I'm Follower - (413601419, 127.0.0.3)] Election Manager starting
10:39:48 [election] [INFO] [I'm Follower - (413601419, 127.0.0.3)] UDP listener started on UDP:9003
10:39:49 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.1...
10:39:49 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.1
10:40:09 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:40:09 [election] [WARNING] [I'm Follower - (413601419, 127.0.0.3)] Election triggered: leader heartbeat timeout
10:40:09 [election] [INFO] [I'm Election - (413601419, 127.0.0.3)] Election started; peers=[406379425, 307279263]
10:40:09 [election] [INFO] [I'm Election - (413601419, 127.0.0.3)] No higher peers, becoming Leader
10:40:09 [server_role] [DEBUG] Closed connection to old leader 406379425
10:40:10 [network_manager] [ERROR] No connection found for 413601419, cannot send message
10:40:10 [membership] [INFO] server 413601419 assigned to group group_0
10:40:10 [membership] [INFO] Leader initialized with server info: {'server_id': 413601419, 'load_info': {'cpu_percent': 9.5, 'memory_percent': 81.2}, 'address': '127.0.0.3'}
10:40:10 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:40:10 [network_manager] [DEBUG] Leader long-lived connection listener started
10:40:10 [server_role] [INFO] [Leader] Notifying followers about new leader: 413601419
10:40:10 [server_role] [INFO] [Leader] Notified follower 406379425 at 127.0.0.2 about new leader
10:40:10 [server_role] [INFO] [Leader] Notified follower 307279263 at 127.0.0.1 about new leader
10:40:10 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Broadcasting COORDINATOR (victory)
10:40:10 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> <broadcast>:9003
10:40:10 [network_manager] [DEBUG] Registered long-lived connection from follower 406379425 at ('127.0.0.3', 62615)
10:40:10 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> <broadcast>:9003
10:40:10 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> <broadcast>:9003
10:40:11 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 406379425, 'timestamp': 1770716410.2109041, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 13.1, 'memory_percent': 80.8}} from 406379425, current memnershiplist is {406379425: '127.0.0.2', 413601419: '127.0.0.3', 307279263: '127.0.0.1'}
10:40:11 [membership] [WARNING] server 406379425 is not existed
10:40:11 [membership] [WARNING] server 406379425 is not existed
10:40:18 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:18 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:18 [network_manager] [DEBUG] Registered long-lived connection from follower 406379425 at ('127.0.0.3', 62619)
10:40:18 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:18 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:18 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:18 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:19 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 413601419, 'timestamp': 1770716419.391575, 'identity': 'LEADER'}
10:40:19 [network_manager] [DEBUG] there are currently 1 followers to send to: [406379425]
10:40:23 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:23 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:23 [network_manager] [DEBUG] Registered long-lived connection from follower 406379425 at ('127.0.0.3', 62622)
10:40:23 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:23 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:23 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:23 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:28 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:28 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:28 [network_manager] [DEBUG] Registered long-lived connection from follower 406379425 at ('127.0.0.3', 62627)
10:40:28 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:28 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:28 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:28 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:29 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 413601419, 'timestamp': 1770716429.3909361, 'identity': 'LEADER'}
10:40:29 [network_manager] [DEBUG] there are currently 1 followers to send to: [406379425]
10:40:33 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:33 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:33 [network_manager] [DEBUG] Registered long-lived connection from follower 406379425 at ('127.0.0.3', 62630)
10:40:33 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:33 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:33 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:33 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:38 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:38 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:38 [network_manager] [DEBUG] Registered long-lived connection from follower 406379425 at ('127.0.0.3', 62633)
10:40:38 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:38 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:38 [election] [INFO] [I'm Leader - (413601419, 127.0.0.3)] Received COORDINATOR from 406379425 (127.0.0.2)
10:40:38 [election] [DEBUG] [I'm Leader - (413601419, 127.0.0.3)] UDP send COORDINATOR -> 127.0.0.2:9003
10:40:39 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 413601419, 'timestamp': 1770716439.387915, 'identity': 'LEADER'}
10:40:39 [network_manager] [DEBUG] there are currently 1 followers to send to: [406379425]
10:40:41 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 406379425, 'timestamp': 1770716440.2070458, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 11.5, 'memory_percent': 81.0}} from 406379425, current memnershiplist is {406379425: '127.0.0.2', 413601419: '127.0.0.3', 307279263: '127.0.0.1'}
10:40:41 [membership] [WARNING] server 406379425 is not existed
10:40:41 [membership] [WARNING] server 406379425 is not existed
10:40:49 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 413601419, 'timestamp': 1770716449.390017, 'identity': 'LEADER'}
10:40:49 [network_manager] [DEBUG] there are currently 1 followers to send to: [406379425]
10:40:51 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 406379425, 'timestamp': 1770716450.208074, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 5.5, 'memory_percent': 81.0}} from 406379425, current memnershiplist is {406379425: '127.0.0.2', 413601419: '127.0.0.3', 307279263: '127.0.0.1'}
10:40:51 [membership] [WARNING] server 406379425 is not existed
10:40:51 [membership] [WARNING] server 406379425 is not existed
10:40:59 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 413601419, 'timestamp': 1770716459.388428, 'identity': 'LEADER'}
10:40:59 [network_manager] [DEBUG] there are currently 1 followers to send to: [406379425]
