11:24:21 [root] [INFO] 日志系统初始化完成。文件保存至: logs/2026-02-10_11-24-21.log
11:24:23 [utills.ip_validator] [DEBUG] IP 127.0.0.5 是回环地址（本地测试用）
11:24:24 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Election Manager starting
11:24:24 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] UDP listener started on UDP:9003
11:24:25 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.1...
11:24:25 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.1
11:24:26 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 245273971, 'timestamp': 1770719066.740196, 'identity': 'LEADER'} from 245273971, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:24:29 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 245273971, 'timestamp': 1770719069.7397609, 'identity': 'LEADER'} from 245273971, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:24:32 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 245273971, 'timestamp': 1770719072.7409868, 'identity': 'LEADER'} from 245273971, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:24:35 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 245273971, 'timestamp': 1770719075.74103, 'identity': 'LEADER'} from 245273971, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:24:38 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 245273971, 'timestamp': 1770719078.7380521, 'identity': 'LEADER'} from 245273971, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:24:41 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 245273971, 'timestamp': 1770719081.741031, 'identity': 'LEADER'} from 245273971, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:24:47 [server.heartbeat] [ERROR] [I'm Follower - 56406045] Failed to send heartbeat to leader 245273971: [Errno 32] Broken pipe
11:24:50 [network_manager] [ERROR] No connection found for 245273971, cannot send message
11:24:53 [network_manager] [ERROR] No connection found for 245273971, cannot send message
11:24:56 [network_manager] [ERROR] No connection found for 245273971, cannot send message
11:24:58 [fault_detection] [WARNING] leader heartbeat timeout detected (16.5s > 15s), start election
11:24:58 [election] [WARNING] [I'm Follower - (56406045, 127.0.0.5)] Election triggered: leader heartbeat timeout
11:24:58 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] Election started; peers=[709734829, 353319114, 421567286, 245273971]
11:24:58 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] Challenging higher peers: [709734829, 353319114, 421567286, 245273971]
11:24:58 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.2:9003
11:24:58 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.3:9003
11:24:58 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.4:9003
11:24:58 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.1:9003
11:24:59 [network_manager] [ERROR] No connection found for 245273971, cannot send message
11:24:59 [fault_detection] [DEBUG] Election in progress, skipping heartbeat timeout check
11:25:00 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] Received COORDINATOR from 709734829 (127.0.0.2)
11:25:00 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] In ELECTION, accepting first COORDINATOR from 709734829
11:25:00 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Reset leader heartbeat timer for new leader 709734829
11:25:00 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 709734829 (127.0.0.2)
11:25:00 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Connecting to new leader 709734829 at 127.0.0.2
11:25:00 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.2...
11:25:00 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.2
11:25:00 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 709734829 (127.0.0.2)
11:25:00 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 709734829 (127.0.0.2)
11:25:01 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 709734829 (127.0.0.2)
11:25:03 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719103.171705, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:06 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719106.1687691, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:09 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719109.168232, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:12 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719112.169302, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:15 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719115.169136, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:18 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719118.170541, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:21 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719121.1705768, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:24 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719124.167451, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:27 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 709734829, 'timestamp': 1770719127.171056, 'identity': 'LEADER'} from 709734829, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:32 [server.heartbeat] [ERROR] [I'm Follower - 56406045] Failed to send heartbeat to leader 709734829: [Errno 32] Broken pipe
11:25:35 [network_manager] [ERROR] No connection found for 709734829, cannot send message
11:25:38 [network_manager] [ERROR] No connection found for 709734829, cannot send message
11:25:41 [network_manager] [ERROR] No connection found for 709734829, cannot send message
11:25:43 [fault_detection] [WARNING] leader heartbeat timeout detected (16.2s > 15s), start election
11:25:43 [election] [WARNING] [I'm Follower - (56406045, 127.0.0.5)] Election triggered: leader heartbeat timeout
11:25:43 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] Election started; peers=[709734829, 353319114, 421567286, 245273971]
11:25:43 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] Challenging higher peers: [709734829, 353319114, 421567286, 245273971]
11:25:43 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.2:9003
11:25:43 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.3:9003
11:25:43 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.4:9003
11:25:43 [election] [DEBUG] [I'm Election - (56406045, 127.0.0.5)] UDP send ELECTION -> 127.0.0.1:9003
11:25:44 [network_manager] [ERROR] No connection found for 709734829, cannot send message
11:25:44 [fault_detection] [DEBUG] Election in progress, skipping heartbeat timeout check
11:25:46 [fault_detection] [DEBUG] Election in progress, skipping heartbeat timeout check
11:25:47 [network_manager] [ERROR] No connection found for 709734829, cannot send message
11:25:47 [fault_detection] [DEBUG] Election in progress, skipping heartbeat timeout check
11:25:47 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] Received COORDINATOR from 353319114 (127.0.0.3)
11:25:47 [election] [INFO] [I'm Election - (56406045, 127.0.0.5)] In ELECTION, accepting first COORDINATOR from 353319114
11:25:47 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Reset leader heartbeat timer for new leader 353319114
11:25:48 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 353319114 (127.0.0.3)
11:25:48 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Connecting to new leader 353319114 at 127.0.0.3
11:25:48 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.3...
11:25:48 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.3
11:25:48 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 353319114 (127.0.0.3)
11:25:48 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 353319114 (127.0.0.3)
11:25:48 [election] [INFO] [I'm Follower - (56406045, 127.0.0.5)] Received COORDINATOR from 353319114 (127.0.0.3)
11:25:53 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 353319114, 'timestamp': 1770719153.398043, 'identity': 'LEADER'} from 353319114, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:25:59 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 353319114, 'timestamp': 1770719159.398307, 'identity': 'LEADER'} from 353319114, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:26:02 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 353319114, 'timestamp': 1770719162.394041, 'identity': 'LEADER'} from 353319114, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
11:26:05 [server.heartbeat] [DEBUG] [I'm Follower - 56406045] Heartbeat received message: HEARTBEAT {'server_id': 353319114, 'timestamp': 1770719165.396395, 'identity': 'LEADER'} from 353319114, current memnershiplist is {709734829: '127.0.0.2', 353319114: '127.0.0.3', 421567286: '127.0.0.4', 56406045: '127.0.0.5', 245273971: '127.0.0.1'}
