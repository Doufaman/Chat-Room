10:48:11 [root] [INFO] 日志系统初始化完成。文件保存至: logs/2026-02-10_10-48-11.log
10:48:14 [utills.ip_validator] [DEBUG] IP 127.0.0.2 是回环地址（本地测试用）
10:48:14 [election] [INFO] [I'm Follower - (886855149, 127.0.0.2)] Election Manager starting
10:48:14 [election] [INFO] [I'm Follower - (886855149, 127.0.0.2)] UDP listener started on UDP:9003
10:48:15 [network_manager] [DEBUG] Starting follower long-lived connection to leader at 127.0.0.1...
10:48:15 [network_manager] [DEBUG] Follower established long-lived connection to leader at 127.0.0.1
10:48:16 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 328443516, 'timestamp': 1770716896.983434, 'identity': 'LEADER'} from 328443516, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1'}
10:48:20 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 328443516, 'timestamp': 1770716899.9869802, 'identity': 'LEADER'} from 328443516, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1'}
10:48:22 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 328443516, 'timestamp': 1770716902.9837818, 'identity': 'LEADER'} from 328443516, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1'}
10:48:25 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 328443516, 'timestamp': 1770716905.9846568, 'identity': 'LEADER'} from 328443516, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1'}
10:48:28 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 328443516, 'timestamp': 1770716908.982927, 'identity': 'LEADER'} from 328443516, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1'}
10:48:29 [server_role] [INFO] [Follower] New follower joined: 347659453 with IP: 127.0.0.3. Updated membership list: {886855149: '127.0.0.2', 328443516: '127.0.0.1', 347659453: '127.0.0.3'}
10:48:31 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 328443516, 'timestamp': 1770716911.983135, 'identity': 'LEADER'} from 328443516, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1', 347659453: '127.0.0.3'}
10:48:37 [server.heartbeat] [ERROR] Failed to send heartbeat to leader 328443516: [Errno 32] Broken pipe
10:48:40 [network_manager] [ERROR] No connection found for 328443516, cannot send message
10:48:42 [fault_detection] [WARNING] leader heartbeat timeout detected, start election
10:48:42 [election] [WARNING] [I'm Follower - (886855149, 127.0.0.2)] Election triggered: leader heartbeat timeout
10:48:43 [election] [INFO] [I'm Election - (886855149, 127.0.0.2)] Election started; peers=[328443516, 347659453]
10:48:43 [election] [INFO] [I'm Election - (886855149, 127.0.0.2)] No higher peers, becoming Leader
10:48:43 [server_role] [DEBUG] Closed connection to old leader 328443516
10:48:43 [network_manager] [ERROR] No connection found for 886855149, cannot send message
10:48:43 [election] [INFO] [I'm Leader - (886855149, 127.0.0.2)] Challenged by 347659453, sending ANSWER to 127.0.0.3
10:48:44 [membership] [INFO] server 886855149 assigned to group group_0
10:48:44 [membership] [INFO] Leader initialized with server info: {'server_id': 886855149, 'load_info': {'cpu_percent': 6.9, 'memory_percent': 75.8}, 'address': '127.0.0.2'}
10:48:44 [membership] [INFO] server added: 328443516
10:48:44 [server_role] [INFO] [Leader] Initialized server 328443516 in membership
10:48:44 [membership] [INFO] server added: 347659453
10:48:44 [server_role] [INFO] [Leader] Initialized server 347659453 in membership
10:48:44 [network_manager] [DEBUG] Starting leader long-lived connection listener...
10:48:44 [network_manager] [DEBUG] Leader long-lived connection listener started
10:48:44 [server_role] [INFO] [Leader] Notifying followers about new leader: 886855149
10:48:44 [server_role] [INFO] [Leader] Notified follower 328443516 at 127.0.0.1 about new leader
10:48:44 [server_role] [INFO] [Leader] Notified follower 347659453 at 127.0.0.3 about new leader
10:48:44 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716924.216251, 'identity': 'LEADER'}
10:48:44 [network_manager] [DEBUG] there are currently 0 followers to send to: []
10:48:44 [server_role] [INFO] [Leader] Sent initial heartbeat after becoming leader
10:48:44 [election] [INFO] [I'm Leader - (886855149, 127.0.0.2)] Broadcasting COORDINATOR (victory)
10:48:44 [election] [DEBUG] [I'm Leader - (886855149, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:48:44 [network_manager] [DEBUG] Registered long-lived connection from follower 347659453 at ('127.0.0.2', 62882)
10:48:44 [election] [DEBUG] [I'm Leader - (886855149, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:48:44 [election] [DEBUG] [I'm Leader - (886855149, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:48:44 [election] [DEBUG] [I'm Leader - (886855149, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:48:44 [election] [DEBUG] [I'm Leader - (886855149, 127.0.0.2)] UDP send COORDINATOR -> <broadcast>:9003
10:48:45 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716925.580986, 'identity': 'LEADER'}
10:48:45 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:48:45 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716924.60427, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 7.7, 'memory_percent': 75.8}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1', 347659453: '127.0.0.3'}
10:48:48 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716928.5831811, 'identity': 'LEADER'}
10:48:48 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:48:48 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716927.6042838, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 4.4, 'memory_percent': 75.6}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1', 347659453: '127.0.0.3'}
10:48:51 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716931.5845041, 'identity': 'LEADER'}
10:48:51 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:48:51 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716930.604279, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 5.4, 'memory_percent': 75.1}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1', 347659453: '127.0.0.3'}
10:48:54 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716934.584148, 'identity': 'LEADER'}
10:48:54 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:48:54 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716933.604285, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 6.1, 'memory_percent': 75.1}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1', 347659453: '127.0.0.3'}
10:48:56 [membership] [INFO] server 328443516 status changed: ACTIVE -> SUSPECT
10:48:56 [fault_detection] [INFO] Suspected servers: [328443516]. Sending probes.
10:48:56 [network_manager] [ERROR] No connection found for 328443516, cannot send message
10:48:57 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716937.584499, 'identity': 'LEADER'}
10:48:57 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:48:57 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716936.604285, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 8.4, 'memory_percent': 75.4}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 328443516: '127.0.0.1', 347659453: '127.0.0.3'}
10:48:57 [fault_detection] [WARNING] 328443516 did not respond -> mark DEAD
10:48:57 [membership] [INFO] server 328443516 status changed: SUSPECT -> DEAD
10:48:57 [membership] [INFO] server removed: 328443516
10:48:57 [fault_discovery] [INFO] Handling dead server 328443516
10:48:57 [membership] [WARNING] server 328443516 is not existed
10:48:57 [membership] [WARNING] server 328443516 is not assigned to any group
10:49:00 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716940.584298, 'identity': 'LEADER'}
10:49:00 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:49:00 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716939.604285, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 9.3, 'memory_percent': 75.1}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 347659453: '127.0.0.3'}
10:49:03 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716943.580225, 'identity': 'LEADER'}
10:49:03 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:49:06 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716946.58268, 'identity': 'LEADER'}
10:49:06 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:49:06 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716945.604285, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 4.7, 'memory_percent': 75.3}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 347659453: '127.0.0.3'}
10:49:09 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716949.582143, 'identity': 'LEADER'}
10:49:09 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:49:09 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716948.5998878, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 5.5, 'memory_percent': 75.0}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 347659453: '127.0.0.3'}
10:49:12 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716952.584527, 'identity': 'LEADER'}
10:49:12 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:49:15 [network_manager] [DEBUG] Leader broadcasting message to followers: HEARTBEAT {'server_id': 886855149, 'timestamp': 1770716955.58432, 'identity': 'LEADER'}
10:49:15 [network_manager] [DEBUG] there are currently 1 followers to send to: [347659453]
10:49:15 [server.heartbeat] [DEBUG] Heartbeat received message: HEARTBEAT {'server_id': 347659453, 'timestamp': 1770716954.601215, 'identity': 'FOLLOWER', 'load_info': {'cpu_percent': 12.0, 'memory_percent': 74.7}} from 347659453, current memnershiplist is {886855149: '127.0.0.2', 347659453: '127.0.0.3'}
